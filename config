#!/usr/bin/env make -f

# Commands...
cpp=cc -E
cc=cc
intr_ld=ld
ld=cc
shell=/bin/sh

# Arguments...
cppargs=-Wall
ccargs=-g -Wall -c -fpic
intr_ldargs=-r
ldargs=-shared

includearg=-I
definearg=-D
libarg=-l
outputarg=-o

includes=common/include
defines=NULL=0
libs=m
incb=\`for include in \$$(includes); do\
	echo -n \" \$$(includearg) \$$\$$include \";done\`
defb=\`for define in \$$(defines); do\
	echo -n \" \$$(definearg) \$$\$$define \"; done\`
libb=\`for lib in \$$(libs); do \
	echo -n \" \$$(libarg) \$$\$$lib \"; done\`

# File extentions...
cext=.c
cppext=.i
objext=.o

# Build targets...
mainobj=main.o
bin=lib/libsweer.so

# Directories...
prefix=/usr/
libdir=lib
headerdir=include
sourcedirs=common

# Files...
tccbuildf=sweer.pjr
header=include/sweer.h
cfiles=\`for dir in \$$(sourcedirs); do echo -n \" \$$\$$dir/*\$$(cext) \"; done\`
cppfiles=\`for dir in \$$(sourcedirs); do echo -n \" \$$\$$dir/*\$$(cppext) \"; done\`
objfiles=\`for dir in \$$(sourcedirs); do echo -n \" \$$\$$dir/*\$$(objext) \"; done\`

all:
	echo "# Generated by config..." > Makefile
	# Commands...
	echo "cpp=$(cpp)" >> Makefile
	echo "cc=$(cc)" >> Makefile
	echo "intr_ld=$(intr_ld)" >> Makefile
	echo "ld=$(ld)" >> Makefile
	echo "shell=/bin/sh" >> Makefile

	# Arguments...
	echo "cppargs=$(cppargs)" >> Makefile
	echo "ccargs=$(ccargs)" >> Makefile
	echo "intr_ldargs=$(intr_ldargs)" >> Makefile
	echo "ldargs=$(ldargs)" >> Makefile

	echo "includearg=$(includearg)" >> Makefile
	echo "definearg=$(definearg)" >> Makefile
	echo "libarg=$(libarg)" >> Makefile
	echo "outputarg=$(outputarg)" >> Makefile

	echo "preargs=$(preargs)" >> Makefile

	echo "includes=$(includes)" >> Makefile
	echo "defines=$(defines)" >> Makefile
	echo "libs=$(libs)" >> Makefile
	echo "incb=$(incb)" >> Makefile
	echo "defb=$(defb)" >> Makefile
	echo "libb=$(libb)" >> Makefile

	# File extentions...
	echo "cext=$(cext)" >> Makefile
	echo "cppext=$(cppext)" >> Makefile
	echo "objext=$(objext)" >> Makefile

	# Build targets...
	echo "mainobj=$(mainobj)" >> Makefile
	echo "bin=$(bin)" >> Makefile

	# Directories...
	echo "prefix=$(prefix)" >> Makefile
	echo "libdir=$(libdir)" >> Makefile
	echo "headerdir=$(headerdir)" >> Makefile
	echo "sourcedirs=$(sourcedirs)" >> Makefile

	# Files...
	echo "tccbuildf=$(tccbuildf)" >> Makefile
	echo "header=$(header)" >> Makefile
	echo "cfiles=$(cfiles)" >> Makefile
	echo "cppfiles=$(cppfiles)" >> Makefile
	echo "objfiles=$(objfiles)" >> Makefile
	echo "" >> Makefile
	cat Makefile.pcs >> Makefile

help:
	cat Makehelp | less
